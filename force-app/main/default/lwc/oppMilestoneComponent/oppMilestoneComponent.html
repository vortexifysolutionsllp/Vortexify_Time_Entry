<template>
    <template if:true={isLoading}>
            <lightning-spinner alternative-text="Loading" size="large"></lightning-spinner>
    </template> 
     <template if:false={isLoading}>
            <!-- <lightning-spinner alternative-text="Loading" size="large"></lightning-spinner> -->
            <div class="slds-p-around_medium slds-text-heading_medium slds-align_absolute-center">
            <h2>Opportunity Name : {oppName} - Milestone</h2>
       
    </div>
    <hr style="margin-top: 0.2em;margin-bottom: 0.2em;"/>
    <lightning-card>
        <div class="slds-form slds-form_stacked">
            <div class="slds-grid slds-gutters">
                <div class="slds-col slds-size_2-of-3 slds-text-heading_small slds-text-color_success">
                    <label class="slds-form-element__label slds-text-heading_small slds-p-left_medium slds-text-color_success" for="fieldName">Opportunity Amount :</label>
                    <!-- <div class="slds-form-element__control slds-text-color_success"> -->
                        {oppAmount}
                    <!-- </div> -->
                </div>
                <div class="slds-col slds-size_1-of-3">
                    <!--<lightning-button variant="brand" label="Add Row" onclick={addRow}></lightning-button>&nbsp;&nbsp;
                        <lightning-button variant="destructive" label="Delete Row" onclick={minusRow}></lightning-button> -->
                </div>
            </div>
        </div>
        <br /><br />
        <!-- Milestone Table -->
        <div class="slds-m-around_medium" style="margin-top: 0.2em;">
        <table class="slds-table slds-table_bordered slds-table_cell-buffer">
            <thead>
                <tr class="slds-line-height_reset">
                    <th class="slds-text-title_caps" scope="col">
                        Sr.No
                    </th>
                    <th class="slds-text-title_caps" scope="col">
                        Payment Milestone Name
                    </th>
                    <th class="slds-text-title_caps" scope="col">
                        Weightage
                    </th>
                     <th class="slds-text-title_caps" scope="col">
                        Tentative Payment Date
                    </th>
                    <th class="" scope="col">
                        <div class="slds-truncate" title="Stage">ACTION</div>
                    </th>
                </tr>
            </thead>
            <tbody>
                <template for:each={milestones} for:item="milestone" for:index="index">
                    
                    <tr key={milestone.Id}>
                        <td data-label="Sr.No"><c-indexchild-l-w-c indexchild={index}></c-indexchild-l-w-c></td>
                        <td data-label="Payment Milestone Name">
                            <lightning-input
                                access-key={index}
                                type="text"
                                value={milestone.Name__c}
                                name="Name__c"
                                onchange={payHandleChange}
                                label={index}
                                variant="label-hidden"
                            ></lightning-input>
                        </td>
                        <td data-label="Weightage">
                            <lightning-input
                                access-key={index}
                                type="decimal"
                                value={milestone.Milestone_Weightage__c}
                                name="Milestone_Weightage__c"
                                onchange={payHandleChange}
                                label={index}
                                variant="label-hidden"
                            ></lightning-input>
                            <div class="error-message" if:true={showError}>Value must be between 0 and 100</div>
                        </td>
                        <td>
                             <lightning-input 
                                  type="date" 
                                  value={milestone.Tentative_Date_of_Payment__c} 
                                  name="Tentative_Date_of_Payment__c" 
                                  onchange={payHandleChange}
                                  label={index}
                                  variant="label-hidden" >
                             </lightning-input>
                        </td>
                        <td data-label="Prospecting">
                           <lightning-button-icon icon-name="action:delete"  alternative-text="Delete" title="Delete" data-id={index} onclick={handleDeleteAction}></lightning-button-icon>
                        </td> 
                    </tr>
                </template>
            </tbody>
        </table>
        </div>
        <br />
        <div class="slds-align_absolute-center">
            <lightning-button variant="success" onclick={handleSubmit} name="submit" label="Submit"></lightning-button>
            &nbsp;&nbsp;
            <lightning-button variant="brand" label="Add Row" onclick={addRow}></lightning-button>
            &nbsp;&nbsp;
            <lightning-button variant="destructive" onclick={handleCancel} name="cancel" label="Cancel"></lightning-button>
        </div>
    </lightning-card>
     </template>
</template>